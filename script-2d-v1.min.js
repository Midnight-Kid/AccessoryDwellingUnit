var show_zero_price="",slidesT=["size","exterior","interior","layout","installation","summary"],$slide=$(".configuration-slide"),zz="22EP8BJUJKCW2YGUN8RS",hc="w-condition-invisible",sB=["upgrades","interior","services","exterior","layout"],sC=["price","model","load"],ccI=".collection-item",ccW=".collection-selection-wrapper",ccF="#model-item-selection",ccFM="#model-item-selection-multiple",ccM=".title-section",ccS=".summary-studio",formatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0});const lookup={"the-twelve":{"price-per-mile":3.5},"the-sixteen":{"price-per-mile":4}};var levels={multiple:[],simple:[]};function loadScript(e,t){var i=document.head,s=document.createElement("script");s.type="text/javascript",s.src=e,s.onreadystatechange=t,s.onload=t,i.appendChild(s)}var shippingCost=null;const redirectToStripe=function(){};function validEmail(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}const getModelName=e=>e.substring(e.lastIndexOf("/")+1);function parseMiles(e){var t=new RegExp("mi|,","igm"),i=e.replace(t,"").trim();return parseInt(i)}function init(){var e={m:[],exterior:[],interior:[],layout:[],upgrades:[],services:[]},t=[],i=[];setTimeout(()=>{$(".div-block-257").removeClass("hidden")},300),$(".models").each(function(){e.m.push({type:$(this).data("type"),name:$(this).data("name"),slug:$(this).data("slug"),price:$(this).data("price"),image:$(this).data("image")})}),$(".rendered-sections").each(function(){var t=$(this).data("type").toLowerCase(),i=$(this).closest(".w-dyn-item").find(".longer-description-html").html(),s=$(this).data("subtype"),a=e[t].find(function(e){return e.subtype==s&&1==e.active}),n=$(this).data("selection").toLowerCase();n=n.includes("simple")?"simple":"multiple";var r=!a&&"simple"==n&&""==$(this).data("parent"),l={type:$(this).data("type"),subtype:$(this).data("subtype"),namesubtype:$(this).data("namesubtype"),name:$(this).data("name"),slug:$(this).data("slug"),price:$(this).data("price"),image:$(this).data("image"),thumbnail:$(this).data("thumbnail"),description:i,active:r,show:!1,order:$(this).data("order"),selection:n,object:$(this).data("object"),group:$(this).data("group"),material:$(this).data("material"),function:$(this).data("function"),parent:$(this).data("parent"),childs:[],activeLevel:[]};e[t].push(l)});var s={multiple:[],simple:[]},a=["simple","multiple"];for(var n in a){var r=a[n];$("."+r+' [class^="box-level"]').each(function(e){var t=$(this).attr("class").split(" ")[0],i=t.replace("box-level-","");levels[r].push(i);var a=$("."+t)[0].outerHTML,n=$(a),l=n.find(".level-"+i)[0].outerHTML;n.find('*[class^="box-level"]').each(function(){$(this).remove()}),n.find(".level-"+i).remove();a=n[0].outerHTML;s[r].push({level:i,html:a,htmlchild:l})})}var l="";$(ccM).parent().find(ccW).length>0&&$(ccM).parent().find(ccW).each(function(){$(this).find(".items-section").length>0&&(l=$(this)[0].outerHTML)}),l=""==l?wrapperDefault:l;var o=$(ccF).length>0?$(ccF)[0].outerHTML:itemDefault;$(ccM).parent().find(ccW).remove(),$(ccF).remove();var d=$(ccFM).length>0?$(ccFM)[0].outerHTML:itemDefault;for(var u in $(ccFM).remove(),$(".btn-slides").each(function(e){$(this).find(".nav-bar-click-link").each(function(e){$(this).attr("x-bind:class","{'selected' : slideActive == '"+e+"', 'not-selective-link' : slideActive < '"+e+"'}")})}),$(".button-wrapper").find("a").attr("x-bind:class",'{"invalid" : !valid}'),e)if("m"!=u&&"services"!=u){var p=e[u],h=[],m=0;p.map(function(e){e.childs=p.filter(t=>t.parent===e.slug),e.childs.length>0&&e.active&&(e.childs[0].active=!0)}),p.map(function(e){if(!h.find(t=>t.value===e.subtype)){var t=p.filter(t=>t.subtype===e.subtype&&""==t.parent);h.push({value:e.subtype,title:e.namesubtype,items:t})}}),h.map(function(e){for(var t in i[e.value]=[],levels[e.items[0].selection]){var a=0==t&&1==e.items[0].active?e.items[0].childs:[];i[e.value].push({level:t,items:a})}var n=$(l);n.find(".title-subsection").text(e.title);var r='<div role="list" class="'+n.find(".items-section").attr("class")+'">';e.items.map(function(e){var t="simple"==e.selection?$(o):$(d);t.removeAttr("id"),t.find(".parent").attr("id",e.slug),t.find(".parent").attr("data-type",e.type);var i=e.function.toLowerCase().replace(" ","-");t.find(".parent").attr("data-object",e.object).attr("data-group",e.group).attr("data-material",e.material).attr("data-function",e.function).addClass(i),t.find("img.image").attr("src",e.thumbnail).attr("srcset",e.thumbnail),t.find(".text-block").text(e.name),t.find(".long_description").html(e.description),t.find(".btn-details").attr("x-on:click",`showPop('${u}', ${m})`),t.find(".details").attr("x-bind:class",'{"show" : studio.'+u+".selected["+m+"].show}").attr("x-on:click",`hidePop('${u}', ${m})`),m++;var a=t.find(".text-price"),n=a.html();n&&(n=n.replace("{price}",e.price),a.html(n),t.find(".text-price span").attr("x-text","setCurrencyPrice("+e.price+", '+ $')")),0===e.price&&a.addClass(hc),""==e.description&&t.find(".btn-details").css({display:"none"}),e.active&&t.addClass("selected"),t.find(".parent").attr("data-selection",e.selection),t.find(".w-embed span").attr("data-name",e.name).attr("data-type",e.type);for(var l=0;l<s[e.selection].length;l++){var c=s[e.selection][l],p=$(c.html).find(".list").attr("class");$(c.html).find(".list").remove();var h=$(c.htmlchild);h.find(".image").attr("x-bind:src","option.thumbnail").attr("x-bind:srcset","option.thumbnail"),h.attr("x-bind:id","option.slug").attr("x-bind:data-type","option.type").attr("x-bind:data-level","'"+c.level+"'").attr("x-bind:class","{'selected' : option.active}");var v=`<template x-if="getShowLevel('${e.slug}', '${c.level}', '${e.type}') == true">\n                        <div class="${p}"><template role="listitem" x-for="option in activeLevel['${e.subtype}'][${l}].items" :key="option">\n                        ${h[0].outerHTML}\n                        </template></div></template>`;t.find(".box-level-"+c.level).html(v)}r+=t[0].outerHTML}),r+="</div>",n.find(".w-dyn-list").html(r),$("."+u+" "+ccM).parent().append(n)})}$("input:required").attr("x-on:input","validate()"),$("form").attr("x-on:keydown.enter.prevent",""),$("#next-button").attr("href","javascript:void(0)"),$("form").attr("x-on:submit","submit(event)"),$(".currency-link").each(function(){var e=$(this).parent().find(".currency").data();$(this).attr("x-on:click",`changeCurrency('${e.currency}')`),t[e.currency]=e.value}),$(".p-currency").each(function(){var e=$(this).text();$(this).attr("x-text",`setCurrencyPrice('${e}')`)});var v=$("#shipping-img").attr("src"),f=0;$(".div-block-257 a").each(function(){var e=$(this).parent().find("a").length;f==e&&(f=0),$(this).attr("x-on:click","goSlide("+f+")"),f++});var g=$(ccS).length>0?$(ccS).children(":first-child").attr("class"):"summary-studio w-dyn-items",y=$(ccS).children().length>0?$(ccS).children(":first-child")[0].outerHTML:$(itemSummaryDefault)[0].outerHTML,b=$(y),w="";w+='<template role="listitem" class="'+g+'" x-for="item in studioItems" :key="item">',b.find(".div-block-295").attr("x-bind:class","{'hidden' : item.type == 'model'}"),b.find("img").attr("x-show","item.thumbnail").attr("x-bind:src","item.thumbnail").attr("x-bind:srcset","item.thumbnail"),b.find(".price-text").attr("x-text","formatMoney(setCurrencyPrice(item.price), false)").removeClass(hc),b.find(".title-tag").attr("x-text","item.name"),b.find(".div-block-295").append(summaryHTML),w+=b.html()+"</template>",$(".custom-items").html(w);let x=window.location.pathname;x=x.split("/").pop();var C=e.m.find(function(e){return e.slug==x}),S={model:C,price:formatter.format(C.price),load:0};for(sec in e)"m"!=sec&&(S[sec]={active:e[sec].length>0?e[sec][0]:{image:null,price:0},selected:e[sec]});return{sections:e,studio:S,studioItems:[],active:!0,shipping:0,customer:customer,upgradesV:"",servicesV:"",interiorV:"",layoutV:"",exteriorV:"",valid:!0,currency:"USD",slideActive:0,summarySlide:slidesT.length-1,installationSlide:slidesT.length-2,show_furniture:!0,await:!0,activeLevel:i,runScript:!1,activeOptionLevel:{slug:"",levels:[]},init:function(){history.pushState(null,"","#size"),this.renderSelection(),this.studio.price=formatter.format(this.setCurrencyPrice(C.price)),this.setPrice();var e=this;$slide.on("beforeChange",function(t,i,s,a){var n=window.location.href;n=n.split("#")[0],e.slideActive=a,history.pushState({},null,n+"#"+slidesT[a])})},setStudio:function(t){if(!this.runScript){this.runScript=!0;var i=t.target,s=$(i).closest(".parent"),a=null;if(0==s.length&&(a=$(t.target).closest(".collection-item-5")),s.length>0&&!$(t.target).hasClass("text-details")){var n=s.attr("id"),r=s.data("type").toLowerCase(),l=e[r].find(function(e){return e.slug==n});if(s.find(".section-3d").addClass("active"),"multiple"==l.selection){if((l.active&&this.activeOptionLevel.slug==l.slug||!l.active||0==l.childs.length)&&(s.toggleClass("selected"),this.studio[r].selected.map(function(e){return e.slug==n&&(e.active=!e.active),e}),l.childs.length>0&&!1===l.active&&l.childs.length>0))for(c in l.childs)l.childs[c].active=!1}else if("simple"==l.selection){s.closest(".collection-list").find(".collection-item").removeClass("selected"),s.parent().addClass("selected");var o=l.subtype;this.studio[r].selected.map(function(e){return e.subtype==o&&(e.active=!1),e.slug==n&&(e.active=!e.active),e})}for(var d=0;d<levels[l.selection].length;d++)this.activeLevel[l.subtype][d].items=[];l.childs.length>0&&1==l.active&&(l.childs[0].active=!0),this.activeLevel[l.subtype][0].items=l.childs,this.activeOptionLevel={slug:"",levels:[]},l.childs.length>0&&l.active&&(this.activeOptionLevel={slug:l.slug,levels:[levels[l.selection][0]]}),this.studio[r].active=l,setTimeout(function(){p.renderSelection(),p.setPrice()},300)}else if(a.length>0){n=a.attr("id"),r=a.data("type").toLowerCase();var u=a.data("level").toLowerCase();l=e[r].find(function(e){return e.slug==n});a.parent().find(".collection-item-5").removeClass("selected"),a.addClass("selected");o=l.subtype;var p=this;this.studio[r].selected.map(function(e){return e.subtype==l.subtype&&(e.active=!1),e}),this.studio[r].selected.map(function(e){if(e.slug==n){e.active=!e.active;var t=e.parent;""!=t&&p.setParent(t,r)}return e});var h=levels[l.selection].findIndex(function(e){return e==u});h++;var m=levels[l.selection][h];this.activeOptionLevel.levels.splice(h);for(d=h;d<levels[l.selection].length;d++)this.activeLevel[l.subtype][d].items=[];l.childs.length>0&&(this.activeLevel[l.subtype][h].items=l.childs,this.activeOptionLevel.levels.push(m)),setTimeout(function(){p.renderSelection(),p.setPrice()},200)}p=this;setTimeout(function(){p.runScript=!1},120)}},setParent(e,t){var i=this;this.studio[t].selected.map(function(s){if(s.slug==e){s.active=!0;var a=s.parent;""!=a&&i.setParent(a,t)}return s})},getShowLevel(e,t,i){i=i.toLowerCase();var s=this.studio[i].selected.find(function(t){return t.slug==e});return this.activeOptionLevel.slug==e&&this.activeOptionLevel.levels.includes(t)||s.active&&"simple"==s.selection},setPrice:function(){var e=C.price;for(const s in this.studio){var t=this.studio[s];if("model"!=s)if(null!=t.price)e=parseFloat(e)+parseFloat(t.price);else for(const t in this.studio[s].selected){var i=this.studio[s].selected[t];!0===i.active&&(e=parseFloat(e)+parseFloat(i.price))}}try{const t=new google.maps.DistanceMatrixService;var s=document.getElementById("Address").value.trim(),a=document.getElementById("City").value.trim(),n=document.getElementById("State").value.trim();const i=getModelName(window.location.pathname),l=lookup[i]["price-per-mile"];if(""!==s&&""!==a&&""!==n){var r="";r+=s+","+a+","+n,t.getDistanceMatrix({origins:["9424 W Walton, Blanchard, MI","5617 104th Pl NE, Marysville, WA"],destinations:[r],unitSystem:google.maps.UnitSystem.IMPERIAL,travelMode:google.maps.TravelMode.DRIVING,avoidHighways:!1,avoidTolls:!1},(t,s)=>{if("OK"==s){const s=l*parseMiles(t.rows[0].elements[0].distance.text),n=l*parseMiles(t.rows[1].elements[0].distance.text);var a=s<n?s:n;"the-twelve"===i?a<600?a=600:a>3600&&(a=3600):"the-sixteen"===i&&(a<800?a=800:a>4250&&(a=4250)),"CAD"===this.currency&&(a+=250),shippingCost=a,e=parseFloat(e)+a,this.studio.price=formatter.format(this.setCurrencyPrice(e)),this.setLoan(e),this.renderSelection()}})}else e=parseFloat(e)+parseFloat(this.shipping),this.studio.price=formatter.format(this.setCurrencyPrice(e)),this.setLoan(e)}catch(t){e=parseFloat(e)+parseFloat(this.shipping),this.studio.price=formatter.format(this.setCurrencyPrice(e)),this.setLoan(e)}},setLoan:function(e){var t=(parseFloat(8)+parseFloat(2.9)+parseFloat(2))/100,i=Math.pow(1+.0689/12,-60);i=e*(.0689/12)/(1-i),i=parseFloat(i)+parseFloat(e*t/60),i=this.setCurrencyPrice(i),this.studio.load=formatter.format(i)+"/mo"},goSlide:function(e){"next"==e&&(e=this.valid?parseInt(this.slideActive)+1:this.slideActive),this.valid=!0;var t=$("input:required").filter(function(e,t){return""==$(t).val()});e==this.summarySlide&&(t.length>0?this.valid=!1:(this.valid=!0,this.setPrice())),this.valid&&$("#slick-slide-control0"+e).click(),e==this.installationSlide&&t.length>0&&(this.valid=!1)},renderSelection(){this.studioItems=[];var e=sB,i=sC;for(const t in this.studio){var s=this.studio[t],a=[];if(!i.includes(t)&&null!=s&&e.includes(t)){var n=s.selected.filter(function(e){return e.active});for(const e in n){a.push(n[e].name);let t={type:n[e].type,name:n[e].name,slug:n[e].slug,price:n[e].price,image:n[e].image?n[e].image:null,thumbnail:n[e].thumbnail?n[e].thumbnail:null};this.studioItems.push(t)}this[t+"V"]=a.join(", ")}}var r="CAD"===this.currency?shippingCost/t.CAD:shippingCost;var l=shippingCost?"Shipping cost: "+formatter.format(r):"Estimated shipping";"Estimated shipping"!==l&&this.studioItems.push({type:"shipping",name:l,price:this.shipping,image:"",thumbnail:v}),this.studioItems.push(C)},formatMoney:function(e,t=!0){return t?formatter.format(e):0==e?show_zero_price:formatter.format(e)},changeZip:function(e){var t=$("#zip-init").text(),i=$("#zip-price").text(),s=e.target.value,a=this;""!=s?$.get("https://api.zip-codes.com/ZipCodesAPI.svc/1.0/CalculateDistance/ByZip?fromzipcode="+t+"&tozipcode="+s+"&key="+zz).done(function(e){e.DistanceInMiles||0==e.DistanceInMiles?(a.shipping=parseFloat(e.DistanceInMiles)*parseFloat(i),a.setPrice(),a.renderSelection()):(a.shipping=0,a.renderSelection())}):(a.shipping=0,a.renderSelection())},validate:function(){0==$("input:required").filter(function(e,t){return""==$(t).val()}).length?this.valid=!0:this.valid=!1},validateForm:function(){var e=$(".w-slider-dot.w-active").index();(e=parseInt(e)+parseInt(1))!=installationSlide?this.goSlide(e):0==$("input:required").filter(function(e,t){return""==$(t).val()}).length&&this.goSlide(e)},submit:function(e){var t=Stripe("pk_live_51IbUhkHy8pZ91dsyEHbItdV3dRUHfxAhBaBYaYQvVrofC3IoygYQcjbEaMUcDhaaWYOvCU30o3zm0hS5mVLZZBQi00nfYUtQmb"),i="https://"+window.location.hostname+"/thank-you",s="https://"+window.location.hostname+"/payment-failure",a=document.getElementById("Email").value,n={lineItems:[{price:"price_1IiUe4Hy8pZ91dsyzSVEk4at",quantity:1}],mode:"payment",successUrl:i,cancelUrl:s};a&&validEmail(a)&&(n.customerEmail=a),t.redirectToCheckout(n).then(function(e){e.error&&(document.getElementById("error-message").textContent=e.error.message,console.log(e.error.message))})},changeCurrency:function(e){this.currency=e,this.setPrice(),$(document).find(".w-dropdown").each(function(e,t){$(t).triggerHandler("w-close.w-dropdown")})},setCurrencyPrice:function(e,i=""){return i+" "+(e/t[this.currency]).toFixed(0)},showPop:function(e,t){this.studio[e].selected[t].show=!0},hidePop:function(e,t){this.studio[e].selected[t].show=!1},showFurniture:function(){var e=this;this.await&&(this.await=!1,setTimeout(function(){e.show_furniture=!e.show_furniture,e.await=!0},120))}}}$(()=>{document.title="Configurator",loadScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyDnH-26A_sEu0vzOa94U5Tfgukhf89ARCE&libraries=&v=weekly",redirectToStripe),loadScript("https://js.stripe.com/v3",redirectToStripe),$slide.slick({dots:!0,infinite:!1,arrows:!1,speed:500,fade:!0,cssEase:"linear",swipe:!1,swipeToSlide:!1}),$(".btn-slides").scroll(()=>{$(this).scrollLeft();$(".btn-slides").scrollLeft()}),$("#open-3d-modal").click(()=>{$(".modal-pop-up._3d-model").removeClass("no-visible")}),$("#close-3d-modal").click(()=>{$(".modal-pop-up._3d-model").addClass("no-visible")})});
